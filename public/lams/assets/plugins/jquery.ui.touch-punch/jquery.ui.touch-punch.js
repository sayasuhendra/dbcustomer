(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else{factory(jQuery);}}(function($){var pointerEnabled=window.navigator.pointerEnabled||window.navigator.msPointerEnabled;$.support.touch=$.support.touch||((typeof Modernizr!=='undefined')?Modernizr.touch:('ontouchend'in document||'createTouch'in document||pointerEnabled));if(!$.support.touch&&!navigator.msPointerEnabled){return;}
var mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,touchHandled;function fixTouch(touch){var winPageX=window.pageXOffset,winPageY=window.pageYOffset,x=touch.clientX,y=touch.clientY;if(touch.pageY===0&&Math.floor(y)>Math.floor(touch.pageY)||touch.pageX===0&&Math.floor(x)>Math.floor(touch.pageX)){x=x- winPageX;y=y- winPageY;}else if(y<(touch.pageY- winPageY)||x<(touch.pageX- winPageX)){x=touch.pageX- winPageX;y=touch.pageY- winPageY;}
return{clientX:x,clientY:y};}
function simulateMouseEvent(event,simulatedType){if((!pointerEnabled&&event.originalEvent.touches&&event.originalEvent.touches.length>1)||(pointerEnabled&&!event.isPrimary)){return;}
event.preventDefault();var evt;if(pointerEnabled){evt=event.originalEvent;}else if(event.originalEvent.changedTouches){evt=event.originalEvent.changedTouches[0];}else{evt=event;}
simulatedEvent=document.createEvent('MouseEvents');coord=fixTouch(evt);simulatedEvent.initMouseEvent(simulatedType,true,true,window,1,evt.screenX,evt.screenY,coord.clientX,coord.clientY,false,false,false,false,0,null);event.target.dispatchEvent(simulatedEvent);}
mouseProto._touchStart=function(event){var self=this;if(touchHandled||(!pointerEnabled&&!self._mouseCapture(event.originalEvent.changedTouches[0]))){return;}
touchHandled=true;self._touchMoved=false;simulateMouseEvent(event,'mouseover');simulateMouseEvent(event,'mousemove');simulateMouseEvent(event,'mousedown');};mouseProto._touchMove=function(event){if(!touchHandled){return;}
this._touchMoved=true;simulateMouseEvent(event,'mousemove');};mouseProto._touchEnd=function(event){if(!touchHandled){return;}
simulateMouseEvent(event,'mouseup');simulateMouseEvent(event,'mouseout');if(!this._touchMoved){simulateMouseEvent(event,'click');}
touchHandled=false;};mouseProto._mouseInit=function(){var self=this;self.element.off('touchstart').off('touchmove').off('touchend');if(pointerEnabled){self.element.on('pointerDown',$.proxy(self,'_touchStart')).on('pointerMove',$.proxy(self,'_touchMove')).on('pointerUp',$.proxy(self,'_touchEnd')).on('MSPointerDown',$.proxy(self,'_touchStart')).on('MSPointerMove',$.proxy(self,'_touchMove')).on('MSPointerUp',$.proxy(self,'_touchEnd'));}else{self.element.on(navigator.msPointerEnabled?'MSPointerDown':'touchstart',$.proxy(self,'_touchStart')).on(navigator.msPointerEnabled?'MSPointerMove':'touchmove',$.proxy(self,'_touchMove')).on(navigator.msPointerEnabled?'MSPointerUp':'touchend',$.proxy(self,'_touchEnd'));self.element.css({msTouchAction:'none'});}
_mouseInit.call(self);};}));